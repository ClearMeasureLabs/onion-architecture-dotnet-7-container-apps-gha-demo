#
# Redgate EULAs
# If you are using any of our products (other than those listed as subscription software on our
# website https://www.red-gate.com/support/license/software-editions), the Redgate Standard
# EULA will apply.
# If you are using subscription software the Redgate Subscription EULA will apply.
# IMPORTANT NOTICES:
# 1 Where you sign a paper version or a bespoke version of the Redgate Standard EULA
# and/or the Redgate Subscription EULA, that paper/bespoke version will take precedence over
# any subsequent click to agree versions of the EULAs presented on download and/or installation;
# and
# 2 The Redgate Standard EULA and/or the Redgate Subscription EULA (whichever one is
# applicable to you) shall prevail over your standard terms and conditions (if any) attached to,
# enclosed with, or referred to in, the purchase order or confirmation of order.
# Redgate Subscription EULA
# Any use of our Subscription Software is subject to the terms of this subscription agreement
# ("Agreement"). Please read the full Agreement carefully.
# You confirm that you accept and agree to be legally bound by all terms and conditions of this
# Agreement by downloading and/or installing and/or using the Subscription Software. If you do
# not accept these terms, do not download, install or use the Subscription Software.
# TERMS AND CONDITIONS
# 1 SUBSCRIPTION
# 1.1 Evaluation. You are entitled to a free trial of the Subscription Software for the purposes
# of deciding whether or not the Subscription Software meets your requirements
# ("Evaluation Period"). During the Evaluation Period the terms in Schedule 1 will apply.
# 1.2 Subscription. In consideration of you paying to us the Subscription Fee, we grant you a
# non-exclusive, non-transferable right to access and use the Subscription Software during
# the Subscription Period in accordance with this Agreement, and subject to any
# applicable Product Specific Terms.
# 1.3 The Subscription is personal to you. You may not rent, lease, sub-license, sell, pledge,
# assign the benefit or delegate the burden of this Agreement or Subscription Software or
# hold this Agreement on trust for any other person.
# 1.4 Except as stated in this Agreement, you have no right to use, incorporate into other
# products, copy, publish, display, modify or translate the Subscription Software or any
# modification, adaptation or copy of the Subscription Software or any part thereof. You
# may only decompile, reverse engineer, or disassemble the source code of the
# Subscription Software either in whole or in part, as expressly permitted under the
# Subscription or under Sections 50(A), (B) and (BA) of the Copyright, Designs and
# Patents Act 1988 (as amended or updated from time to time) or other applicable law.
# 1.5 You shall not use the Subscription Software to manufacture or distribute a product that is
# substantially similar to or competitive with our software.
# 2 OWNERSHIP OF INTELLECTUAL PROPERTY RIGHTS
# 2.1 You acknowledge that i) all Intellectual Property Rights in or relating to the Subscription
# Software are owned by or licensed to us, ii) except as expressly granted under this
# Agreement, you have no rights in the Subscription Software, and iii) we shall have the
# right to use your name and/or logo on customer lists on our website and in other
# marketing material.
# 2.2 You hereby agree to refrain from any action which would diminish our Intellectual
# Property Rights in or relating to the Subscription Software or which would call those
# rights into question.
# 2.3 You agree not to delete, remove or alter any trade marks, logos, copyright notices or
# similar proprietary devices of ours, including without limitation any electronic watermarks
# or other identifiers that may be incorporated in the Subscription Software. All
# representations of our name or logo must remain as originally distributed.
# 3 PAYMENT
# 3.1 The Subscription Fee (together with any levies, duties and/or taxes imposed on you in
# your jurisdiction (including, but not limited to, value added tax, sales tax, use tax and
# withholding tax)) shall be due and payable by you when we issue a licence key to you for
# the Subscription Software.
# 3.2 The Renewal Fee (together with any levies, duties and/or taxes imposed on you in your
# jurisdiction (including, but not limited to, value added tax, sales tax and withholding tax))
# shall be due and payable by you on the payment date of the invoice.
# 3.3 You may not deduct any amounts from the Subscription Fees or the Renewal Fees,
# unless otherwise specified in this Agreement.
# 3.4 Where you have obtained the Subscription Software through a Reseller, the terms you
# have agreed with such Reseller in relation to payment and invoicing will apply instead of
# this clause 3.
# 4 CONFIDENTIALITY
# 4.1 The structure, organisation, and source code of the Subscription Software are
# proprietary confidential information of ours and our licensors. You agree not to provide or
# disclose any confidential information of ours (including relating to or derived from the
# Subscription Software) to any third party, including where such confidential information is
# derived under any applicable law as set out in clause 1.4.
# 4.2 Other than the disclosures referred to in our Privacy Notice, we agree not to provide or
# disclose to any third party any information of a confidential nature in any form
# whatsoever which is disclosed to us by you or on behalf of you.
# 4.3 The provisions of clauses 4.1 and 4.2 will not apply to the extent that:
# 4.3.1 such information is in the receiving party's possession free from any
# restriction as to its use or disclosure; or
# 4.3.2 the receiving party can demonstrate that such information is in the
# public domain (other than as a result of an unauthorised disclosure); or
# 4.3.3 such information is required to be disclosed by law.
# 4.4 No information to which clause 4.3.3 applies shall be disclosed to a third party unless
# and until the receiving party has (unless prevented from doing so by law) (i) given the
# disclosing party reasonable written notice of such proposed disclosure, (ii) consulted with
# the disclosing party, and (iii) agreed with the disclosing party the content of the
# disclosure, provided that it shall not limit the disclosure in a manner which would prevent
# the receiving party from complying with a statutory or regulatory obligation or court order.
# 4.5 If you have entered into a separate confidentiality agreement with us, and there are
# inconsistencies between the terms of the confidentiality agreement and this clause 4, the
# terms of the confidentiality agreement shall prevail over this clause 4.
# 5 WARRANTY AND SUPPORT
# 5.1 Subject to clause 10.8.2(i), we warrant that:
# 5.1.1 we own the Intellectual Property Rights in the Subscription Software
# and/or have the right to grant a licence to you;
# 5.1.2 in creating the Subscription Software, we have not knowingly infringed
# the intellectual property rights of third parties; and
# 5.1.3 for a period of 90 days from the first installation of the Subscription
# Software (or, if applicable, 90 days from the end of the Evaluation Period if you continue
# to use the Subscription Software) the Subscription Software shall operate substantially in
# accordance with its description. However, you acknowledge that the Subscription
# Software is of such a complexity that there will be inherent defects and that therefore we
# can give no warranty that the Subscription Software is free from error or defect or that
# operation of the Subscription Software shall be uninterrupted.
# 5.2 Other than as provided for in clauses 5.1 and 10.8.2(i), we do not offer any warranty
# related to the Subscription Software and/or the support provided, either express or
# implied, including but not limited to implied warranties of fitness for purpose or
# satisfactory quality, save for any non-excludable rights and remedies you may have
# under law. The Subscription Software has been developed as a standard product for use
# by a wide variety of users and so we are unable to warrant that the Subscription
# Software will meet any particular user needs. You shall take full responsibility for
# ensuring that the Subscription Software is suitable for your intended purposes and to
# facilitate investigation into such suitability, we offer a free Evaluation Period.
# 5.3 Support. In relation to and without prejudice to the generality of clause 5.2 above, we
# provide support to users of Subscription Software via our web site, user forums, by email
# and by phone. The support is provided subject to the terms of this Agreement. You
# accept that, although we will use reasonable endeavours to solve problems identified by
# you, the nature of software is such that no guarantee can be provided that any particular
# problem will be solved. You accept that, where a particular problem requires an update
# to the Subscription Software, the scheduling of any new releases and the functionality
# those releases contain shall be under our sole control.
# 6 LIMITATION AND EXCLUSION OF LIABILITY
# 6.1 Nothing in this Agreement shall limit or exclude either party's liability for: (a) personal
# injury or death resulting from negligence, (b) fraud; or (c) any other matter for which
# liability cannot be excluded by law.
# 6.2 Subject to clauses 6.1 and 10.8.2(ii), neither party shall be liable to the other party for
# any indirect, special or consequential loss or damage whatsoever arising under or in
# relation to this Agreement (whether in contract, tort (including negligence), breach of
# statutory duty, restitution or otherwise). We shall not be liable to you for any of the
# following types of loss or damage arising under or in relation to this Agreement: (a) any
# loss of profits, business, contracts, anticipated savings, goodwill, or revenue; or (b) any
# loss, or corruption, of software or data; or (c) any loss of use of hardware, software or
# data.
# 6.3 Subject to clauses 6.1, 6.2 and 9.2 our aggregate liability under and in connection with
# this Agreement howsoever caused shall be limited in all cases to the aggregate sum of
# the Subscription Fees paid in the 12 months prior to the event giving rise to the liability.
# 6.4 The provisions of this clause allocate risks under this Agreement between you and us,
# and the Subscription Fees reflect this allocation of risks and these limitations of liability.
# 7 SUBSCRIPTION PERIOD, TERMINATION AND RETIRED SOFTWARE
# 7.1 The Subscription shall commence on the Subscription Start Date and, unless terminated
# earlier in accordance with this clause 7, shall continue for the Initial Subscription Period
# and, thereafter, the Subscription shall be automatically renewed for successive periods
# of 12 months (each a "Renewal Period"), unless either party notifies the other party of
# termination, in writing, at least 30 days before the end of the Initial Subscription Period or
# any Renewal Period, in which case the Subscription shall terminate upon the expiry of
# the applicable Initial Subscription Period or Renewal Period.
# 7.2 If we do not receive the Subscription Fee or the relevant Renewal Fee from you, we
# reserve the right to terminate your Subscription 30 days after the payment due date.
# 7.3 The Subscription will terminate automatically if you uninstall and cease use of the
# Subscription Software, or uninstall and destroy or voluntarily return the Subscription
# Software to us, and notify us that you have done so.
# 7.4 Where the Subscription is terminated in accordance with clause 7.4 or clause 7.3, then
# the Agreement shall terminate in its entirety.
# 7.5 Upon termination of this Agreement: (a) you must cease use of the Subscription
# Software, and uninstall, destroy or put beyond use all copies of the Subscription
# Software in your possession or control; and (b) the provisions of clauses 1.5, 4, 5.2, 6, 7,
# 9, 10.1 to 10.7 and 11 will remain in effect.
# 7.6 The termination of this Agreement howsoever arising shall not affect the rights, duties
# and liabilities of either party accrued prior to termination.
# 7.7 Retired Software. We reserve the right to retire the Subscription Software (and
# therefore terminate the Subscription) on written notice by us at any time to come into
# effect at the end of the then current Initial Subscription Period or Renewal Period (as the
# case may be).
# 8 DATA COLLECTION AND PRIVACY NOTICE
# 8.1 Information on the data we collect about you and how we treat that data is set out in our
# Privacy Notice, which can be viewed at
# https://www.red-gate.com/our-company/about/legal.
# 9 THIRD PARTY CLAIMS
# 9.1 You agree to indemnify us from any loss or damage whether in contract, tort (including
# negligence), breach of statutory duty, restitution or otherwise, if a third party claims that
# your use of the Subscription Software causes any such loss or damage, except in the
# circumstances in clause 9.2 below.
# 9.2 If any claim is brought against you alleging that your use of the intellectual property
# associated with the Subscription Software in accordance with this Agreement infringes
# the rights of any third party, you shall promptly notify us and supply full details of the
# claim. The two of us shall consult together on an appropriate course of action and seek
# to minimise the effect of any claim on the respective businesses. We shall have the right,
# but not the obligation, to take control of all negotiations and litigation arising out of the
# claim. We will pay any damages and costs awarded against you in connection with any
# claim subject to a maximum of the aggregate sum of Subscription Fees paid to us by you
# in the 12 months prior to the claim. We shall have the right, at our sole choice, to either:
# (i) use reasonable endeavours to negotiate terms for continued use by you of the
# claimed infringing software; or (ii) use reasonable endeavours to amend the Subscription
# Software to make it non-infringing; or (iii) terminate this Agreement with immediate effect
# and in such event, we shall refund to you all Subscription Fees paid.
# 10 GENERAL
# 10.1 Governing law and settlement of disputes. This Agreement (and any dispute or
# claim relating to it, or its formation, existence, construction, performance, validity or
# termination) will be governed by and construed in accordance with the laws of England.
# The courts of England and Wales shall have non-exclusive jurisdiction to settle any
# dispute or claim arising out of or in connection with this agreement or its subject matter
# or formation (including non-contractual disputes or claims). Without prejudice to any
# other rights or remedies that we may have, you acknowledge and agree that damages
# alone would not be an adequate remedy for any breach of clauses 1, 2, 4 and/or
# Schedule 2 by you. Accordingly, we shall be entitled to seek an injunction or other
# equitable relief for any threatened or actual breach of those clauses.
# 10.2 Compliance with applicable law. You agree that, notwithstanding clause 10.1 above,
# you may be subject to additional laws in other jurisdictions with respect to your use of the
# Subscription Software in such jurisdictions. You agree to comply with the laws of any
# such jurisdiction including, without limitation, any applicable export laws or regulations.
# 10.3 Severability. If any provision or part of any provision in this Agreement is found to be
# illegal, invalid or unenforceable for any reason then the remaining provisions or part
# provisions remain unaffected and the parties shall meet promptly to discuss in good faith
# and agree an alternative provision or part provision that provides as closely as possible,
# the same commercial effect as the original.
# 10.4 No waiver. No failure or delay by any party to exercise any right, power or remedy will
# operate as a waiver of it, nor will any partial exercise preclude any further exercise of the
# same, or of some other right, power or remedy.
# 10.5 No third party rights. We and you do not intend that any of this Agreement will be
# enforceable by virtue of the Contracts (Rights of Third Parties) Act 1999 by any person
# not a party to it and all rights by virtue of the Contracts (Rights of Third Parties) Act 1999
# are hereby excluded.
# 10.6 Entire agreement. This Agreement contains all the terms which the parties have
# agreed in relation to the subject matter of this Agreement and supersedes any prior oral
# agreements, representations or understandings between the parties in relation to such
# subject matter.
# 10.7 Revisions to terms. For click to agree versions of the Agreement only, we reserve the
# right to revise the terms of this Agreement by updating this Agreement on our website.
# You are advised to check the website periodically for notices concerning such revisions.
# If you do not agree with any such revision you may terminate your agreement within 10
# days of the relevant revision without liability to us. Your continued use of the
# Subscription Software shall be deemed to constitute acceptance of any revised terms.
# No revisions will apply retrospectively. Any bespoke versions of this Agreement shall
# continue to apply to all future downloads or installation of Software and shall always take
# precedence over any click to agree versions presented at download or installation of
# such Software.
# 10.8 Consumer regulations.
# 10.8.1 This clause applies to Consumers only. You shall have the right to cancel this
# Agreement 14 days from the date you agree to be obliged to pay for the Subscription
# Software under this Agreement. Should you wish to cancel this Agreement under this
# clause 10.8, you must notify us of your decision to cancel by either: (a) returning a
# completed Model Cancellation Form (a copy of which is available here:
# https://www.red-gate.com/website/legal) to us; or
# (b) sending us an email clearly confirming your decision to:
# orders@red-gate.com. If you have any complaints about this Agreement, including
# complaints about the Subscription Software, please raise these with Red Gate using the
# relevant contact details: https://www.red-gate.com/our-company/contact-us
# 10.8.2 Australian consumer law
# (i) Despite clause 5 our goods and services come with guarantees that cannot be excluded
# under the Australian Consumer Law. For major failures with the service, you are
# entitled; (i) to cancel your service contract with us; and (ii) to a refund for the unused
# portion, or to compensation for its reduced value. You are also entitled to choose a
# refund or replacement for major failures with goods. If a failure with the goods or a
# service does not amount to a major failure, you are entitled to have the failure rectified in
# a reasonable time. If this is not done you are entitled to a refund for the goods and to
# cancel the contract for the service and obtain a refund of any unused portion. You are
# also entitled to be compensated for any other reasonably foreseeable loss or damage
# from a failure in the goods or service. If you think that the Subscription Software does
# not operate substantially in accordance with its description within the warranty period
# specified in clause 5.1.3, and you wish to make a claim under the warranty in clause
# 5.1.3, you must contact us using the relevant contact details:
# https//www.red-gate.com/our-company/contact-us and provide details of how you think
# that the Subscription Software does not meet that warranty in clause 5.1.3.
# (ii) Despite clause 6 and any other provision in this Agreement, if the Competition and
# Consumer Act 2010 (Cth) (including the Australian Consumer Law in Schedule 2 of that
# Act) provides that there is a guarantee in relation to any good or service supplied by us
# in connection with this Agreement, and our liability for failing to comply with that
# guarantee cannot be excluded but may be limited, then clauses 6.2, 6.3 and clause 3 of
# Schedule 1 and any other limitation of our liability in this Agreement, do not apply to that
# liability and instead our liability for such failure is limited to (at our election: (i) in the case
# of a supply of goods, replacing the goods or of acquiring equivalent goods, or paying the
# cost of having the goods repaired; or (ii) in the case of a supply of services, supplying
# the services again or paying the cost of having the services supplied again.
# 11 DEFINITIONS
# 11.1 In this Agreement, capitalised terms shall have the meanings set out below or the
# relevant Schedule.
# "Initial Subscription Period" means the initial Subscription period agreed with us, and
# as stated on the invoice starting on the Subscription Start Date;
# "Intellectual Property Rights" means patents, registered designs, registered trade and
# service marks, registered copyright and modifications to and applications for any of the
# foregoing and the right to apply for protection for such registered rights anywhere in the
# world and inventions, discoveries, copyright, database right, unregistered trade or
# service marks, brand names or know-how and any similar or equivalent rights whether
# capable of registration or not arising, applied for or granted worldwide;
# "OSE" means an Operating System Environment which is all or part of an operating
# system instance, or all or part of a virtual (or otherwise emulated) operating system
# instance which enables separate machine identity (primary computer name or similar
# unique identifier) or separate administrative rights;
# "Privacy Notice" means the document entitled Privacy Notice on our website
# (https://www.red-gate.com/our-company/about/legal);
# "Product Specific Terms" means the terms applicable to a specific item of Subscription
# Software as set out in Schedule 2;
# "Renewal Fee" means the fees payable by you under this Agreement to us for the
# Subscription during the Renewal Period (excluding VAT and all other relevant taxes,
# where applicable), as detailed by us from time to time including through our website, as
# part of a written quotation or renewal;
# "Renewal Periods" has the same meaning set out in clause 7.1;
# "Reseller" means any third party authorised by us to sell licences to the Subscription
# Software;
# "Subscription" means the right to use the Subscription Software, set out in clause 1
# and/or Schedules 1 and 2 as appropriate;
# "Subscription Fee" means the fee payable by you under this Agreement to us
# (excluding VAT and all other relevant taxes, where applicable), as detailed by us from
# time to time including through our website, as part of a written quotation or renewal;
# "Subscription Period" means the Initial Subscription Period together with any
# subsequent Renewal Periods;
# "Subscription Software" means the software, listed under "Subscription Software" on
# our website: https://www.red-gate.com/support/license/software-editions, selected by
# you and licensed to you under this Agreement;
# "Subscription Start Date" means the date of the invoice issued to you by us under this
# Agreement;
# "We", "Our", "Us" and the non-capitalised versions means Red Gate Software Limited, a
# company registered in England with company number 3857576 and registered office at
# Newnham House, Cambridge Business Park, Cambridge CB4 0WZ, United Kingdom;
# "You", "Your" and the non-capitalised versions means, whether the Subscription
# Software is obtained directly from us or through a Reseller, (a) where an individual
# downloads and/or installs the Subscription Software on an OSE for his own personal
# use, that individual (a "Consumer"); or (b) where an individual downloads and/or installs
# the Subscription Software on a OSE for business use, that individual's employer (and we
# will assume that such individual has the authority to purchase on behalf of their
# employer); or (c) where an entity or organisation downloads and/or installs the
# Subscription Software on a OSE for use by its employees, that entity or organisation
# (and such entity shall be responsible for all use by its employees of the Subscription
# Software).
# Schedule 1
# Evaluation Period
# 1 We grant you the right to use the Subscription Software for the Evaluation Period. The
# length of the Evaluation Period is confirmed on the relevant product page for the
# Subscription Software on our website. The Evaluation Period may be extended by
# written agreement with us.
# 2 To the extent permitted by law and subject to the other non-excludable rights and
# remedies you may have under law in relation to the Subscription Software, during the
# Evaluation Period, you hereby agree that the Subscription Software is provided AS IS
# with no representation, guarantee or warranty of any kind as to its functionality, quality,
# performance, suitability or fitness for purpose. All other terms, conditions,
# representations and warranties expressed or implied whether by statute or otherwise are
# hereby expressly excluded.
# 3 Subject to clause 10.8.2(ii) of this Agreement, we shall not be liable for any claim,
# damages or other liability arising from or in connection with your use of the Subscription
# Software during the Evaluation Period.
# 4 For the avoidance of doubt, during the Evaluation Period: (a) clauses 5.1, 6.3 and 9.2 of
# this Agreement shall not apply; and (b) clause 9.1 shall apply except that the reference
# to clause 9.2 is deleted.
# 5 Before or upon expiry of the Evaluation Period:
# (a) if, in your sole opinion, the Subscription Software has met your requirements, and you
# wish to continue to use the Subscription Software beyond the end of the Evaluation
# Period, you can decide whether to obtain the equivalent Subscription Fee version. Once
# the appropriate Subscription has been obtained, this Agreement shall continue in force
# (except that this Schedule 1 shall no longer apply).
# (b) if you decide that the Subscription Software does not meet your requirements, or
# otherwise do not wish to enter into a paid up Subscription, then you shall destroy the
# Subscription Software and all copies, in any form including partial copies or modifications
# of the Subscription Software received from us or made in connection with this
# Subscription and all documentation relating thereto. Any rights of yours to use the
# Subscription Software shall cease.
# Schedule 2
# Product Specific Terms
# 1 Definitions
# 1.1 In this schedule, the following definitions shall apply:
# "Client Component" means, where the Subscription Software is Per OSE Subscription
# Software, any component of the Per OSE Subscription Software directed to or otherwise
# provided for accessing the Server Component;
# "Per Capacity Software" means any or all of the software listed on our website:
# https://www.red-gate.com/support/license/software-editions, as licensed on a capacity
# basis;
# "Per OSE Subscription Software" means any or all of the Subscription Software listed
# on our website: https://www.red-gate.com/support/license/software-editions, as licensed
# on a "Per OSE" basis;
# "Server Component" means, where the Subscription Software licensed to you under
# this Agreement is Per OSE Subscription Software, the server-based components on a
# single OSE;
# "Tier" means a pricing tier as defined on our website, at
# http://www.red-gate.com/support/license/capacity-model for the Subscription Software;
# and
# "True Up" means an annual evaluation of the suitability of the Tier chosen for the Per
# Capacity Software.
# 2 Type of Software
# 2.1 Where the Subscription Software is Per Capacity Software or Per OSE Subscription
# Software the relevant additional terms below shall apply to limit the Subscription granted
# in clause 1 of this Agreement:
# Per Capacity Software
# * It is your responsibility to decide, at the point of purchase, which Tier is suitable for
# your intended use of the Subscription Software over the Initial Subscription Period.
# * You will receive an email annually requiring you to conduct a True Up. You are
# required to notify us of the outcome of the True Up if a different Tier is applicable to
# your Subscription, and:
# * if your Initial Subscription Period was for a period of 12 months, we will issue to
# you an invoice for the new applicable Tier which will apply from the start of the
# Renewal Period; or
# * if you have purchased a multi-year Initial Subscription Period, we will issue you
# with an invoice for any increase in Subscription Fees between the Tier you have
# paid for and the Tier that is applicable after the True Up for the remainder of the
# Initial Subscription Period, based on the Subscription Fee.
# * The Subscription Fee payable to us will vary depending on the Tier applicable to
# your Subscription.
# * If you do not True Up before the expiry of the Initial Subscription Period or the expiry
# of any Renewal Period and you do not terminate your Subscription, your
# Subscription will automatically renew for the same Tier and we will issue an invoice
# for the relevant Renewal Period based on that Tier.
# Per OSE Subscription Software
# * The Server Component is licensed for use on a single OSE owned, leased and/or
# controlled by you for internal use.
# * Where the Per OSE Licensed Software includes a Client Component, you may use
# and install such Client Component on more than one OSEs leased and/or controlled
# by you for internal use.
# 3. SQL Data Catalog
# 3.1 SQL Data Catalog is licensed on a Per OSE basis;
# 3.1.1 If you are using SQL Data Catalog with an Azure Database (PaaS)
# environment, you are entitled to deploy either 1 managed instance or up to 5
# single Databases for each Per OSE Licensed Software entitlement.
# LAST UPDATED: JANUARY 29 2020
#

from sqlfluff.core.rules.base import (
    BaseRule,
    LintResult,
    RuleContext,
)


def has_primary_key_constraint(segments):
    for segment in segments:
        if segment.is_type("table_constraint") and len(segment.segments) > 0:
            if any(s.raw == "PRIMARY" for s in segment.segments):
                return True

        if has_primary_key_constraint(segment.segments):
            return True
    return False


class Rule_Flyway_L001(BaseRule):
    """CREATE TABLE statements must have a PRIMARY KEY constraint"""

    groups = ("all",)

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

    def _eval(self, context: RuleContext):
        if context.segment.is_type("create_table_statement"):
            if not has_primary_key_constraint(context.segment.segments):
                return LintResult(
                    anchor=context.segment,
                    description=f"CREATE TABLE statement without a PRIMARY KEY constraint",
                )
